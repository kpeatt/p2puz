!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=11)}([function(e,t){e.exports=_},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),s=function(){function e(){o(this,e)}return a(e,[{key:"$",value:function(e){return this.$el.find(e)}},{key:"append",value:function(e){return this.$el.append(this._as$(e)),this}},{key:"appendTo",value:function(e){return this.$el.appendTo(this._as$(e)),this}},{key:"clear",value:function(){return this.$el.empty(),this}},{key:"remove",value:function(){return this.$el.remove(),this}},{key:"_as$",value:function(t){return t instanceof e?t.$el:(0,u.default)(t)}}]),e}(),l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.$el=(0,u.default)(e.template||"<div>"),n}return i(t,s),a(t,[{key:"setPresenter",value:function(e){this.presenter=e}},{key:"hide",value:function(){return this.$el.hide(),this}},{key:"show",value:function(){return this.$el.show(),this}},{key:"setExclusiveClass",value:function(e,t){t=t.split(" ").map(function(t){return e+"-"+t}).join(" ");var n="_classes_"+e,r=this[n];if(r!==t)return r&&this.$el.removeClass(r),this.$el.addClass(t),this[n]=t,this}},{key:"hasExclusiveClass",value:function(e,t){t=t.split(" ").map(function(t){return e+"-"+t}).join(" ");var n="_classes_"+e;return new RegExp("(?:^| )"+t+"(?:$| )").test(this[n]||"")}}]),t}(),c=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!e.view)throw new Error("view is required");return n.view=e.view,n.view.setPresenter(n),e.el&&(0,u.default)(e.el).append(n.$el),n}return i(t,s),a(t,[{key:"hide",value:function(){return this.view.hide(),this}},{key:"show",value:function(){return this.view.show(),this}},{key:"$el",get:function(){return this.view.$el}}]),t}();t.default={View:l,Presenter:c}},function(e,t){e.exports=jQuery},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),a={};["puz","json"].forEach(function(e){a[e]=n(23)("./"+e).default});var u=function(e){function t(e,n){r(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"cursor","letter"));return i.rows=e,i.cols=n,i.size=e*n,i.squares=[],i.clues={},i.meta={title:"",author:"",copyright:""},i.state=new c(i),i._initGrid(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),i(t,[{key:"_init",value:function(){if(this._matchCluesAndGrid(),null==this.currentSquare||null==this.currentOrientation){var e=this.currentOrientation||"across",t=this.findSquare({from:this.currentSquare||this.squares[0],orientation:e,test:function(e){return e.isWhite}});this.moveCursor(t,e)}return this}},{key:"addClue",value:function(e,t,n){this.clues[t]||(this.clues[t]=[]),this.clues[t].push(new l(this,this.clues[t].length,e,t,n))}},{key:"save",value:function(e){return a[e].save(this)}},{key:"moveCursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentOrientation;e&&(this.state.cursor=e.idx,this.state.orientation=t,this.emit("cursor",this.currentSquare,this.currentOrientation))}},{key:"getSquare",value:function(e,t){if(!(e<0||t<0||e>this.lastRow||t>this.lastCol))return this.squares[this.rows*e+t]}},{key:"findSquare",value:function(e){var t=e.test,n=e.from,r=e.orientation,i=void 0===r?this.currentOrientation:r,o=e.direction,a=void 0===o?"next":o,u=e.inWord,s=void 0!==u&&u,l=e.iterate,c=void 0!==l&&l;"current"===n&&(n=this.currentSquare);var f=n;do{if(!f)return;if(s&&!f.isSameWord(n,i))return;if(t(f,i,a)&&!c)return f;f=f[a][i]}while(f!==n)}},{key:"forEachSquare",value:function(e,t){e.from=e.from||this.squares[0],e.direction=(e.direction||"next")+"Wrap",e.iterate=!0,e.test=e.test||t,this.findSquare(e)}},{key:"findWordStart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentOrientation;if("current"===e&&(e=this.currentSquare),e)return e.clues[t].square}},{key:"findWordEnd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentOrientation;return this.findSquare({from:e,orientation:t,test:function(e){return e.isEnd(t)}})}},{key:"findSquaresInWord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentOrientation,n=[];return this.forEachSquare({from:this.findWordStart(e,t),orientation:t,inWord:!0,test:function(e){return n.push(e)}}),n}},{key:"_initGrid",value:function(){for(var e=0;e<this.rows;++e)for(var t=0;t<this.cols;++t){var n=e*this.rows+t;this.squares.push(new s(this,e,t,n,"",0))}var r=!0,i=!1,o=void 0;try{for(var a,u=this.squares[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var l=a.value;l.prev={across:this.getSquare(l.row,l.col-1),down:this.getSquare(l.row-1,l.col)},l.next={across:this.getSquare(l.row,l.col+1),down:this.getSquare(l.row+1,l.col)},l.prevWrap={across:l.prev.across||this.getSquare(l.row-1,this.lastCol),down:l.prev.down||this.getSquare(this.lastRow,l.col-1)},l.nextWrap={across:l.next.across||this.getSquare(l.row+1,0),down:l.next.down||this.getSquare(0,l.col+1)}}}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}}},{key:"_matchCluesAndGrid",value:function(){var e=this,t={};for(var n in this.clues){t[n]={};var r=!0,i=!1,o=void 0;try{for(var a,u=this.clues[n][Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;t[n][s.number]=s}}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}}var l=null;["across","down"].forEach(function(n){e.forEachSquare({orientation:n},function(e){var r=t[n][e.number];(!l||e.number!==l.number&&r)&&(l=r)&&(l.square=e),e.clues[n]=e.isWhite?l:null})})}},{key:"currentSquare",get:function(){return this.squares[this.state.cursor]}},{key:"currentOrientation",get:function(){return this.state.orientation}},{key:"oppositeOrientation",get:function(){return"across"===this.state.orientation?"down":"across"}},{key:"currentClue",get:function(){return this.currentSquare.clues[this.currentOrientation]}},{key:"oppositeClue",get:function(){return this.currentSquare.clues[this.oppositeOrientation]}},{key:"lastCol",get:function(){return this.cols-1}},{key:"lastRow",get:function(){return this.cols-1}}],[{key:"load",value:function(e,t){var n=a[e].load(t);if(n)return n._init()}},{key:"fetch",value:function(e,n){return Promise.resolve(a[e].fetch(n)).then(function(n){return t.load(e,n)})}}]),t}();t.default=u;var s=function(){function e(t,n,i,o,a,u){r(this,e),this.puzzle=t,this.row=n,this.col=i,this.idx=o,this.solution=a,this.number=u,this.prev=null,this.next=null,this.prevWrap=null,this.nextWrap=null,this.shapebg=null,this.clues={}}return i(e,[{key:"isStart",value:function(e){return!this.isBlack&&(!this.prev[e]||this.prev[e].isBlack)}},{key:"isEnd",value:function(e){return!this.isBlack&&(!this.next[e]||this.next[e].isBlack)}},{key:"isSameWord",value:function(e,t){return this.clues[t]===e.clues[t]}},{key:"letter",get:function(){return this.puzzle.state.grid[this.idx]||""},set:function(e){this.puzzle.state.grid[this.idx]=e,this.puzzle.emit("letter",this,e)}},{key:"isBlack",get:function(){return"."===this.solution}},{key:"isWhite",get:function(){return!this.isBlack}},{key:"isEmpty",get:function(){return!this.isBlack&&""===this.letter}},{key:"isCorrect",get:function(){return this.solution===this.letter}}]),e}(),l=function e(t,n,i,o,a){r(this,e),this.idx=n,this.number=i,this.orientation=o,this.text=a,this.square=null},c=function e(t){r(this,e),this.cursor=null,this.orientation=null,this.grid=t.squares.map(function(e){return""})}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e),this._eventEmitter=this,this._registerEventTypes.apply(this,arguments)}return i(e,[{key:"_registerEventTypes",value:function(){this._callbacks||(this._callbacks={});for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;this._callbacks[s]||(this._callbacks[s]=[])}}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}}},{key:"on",value:function(e,t){if(!this._callbacks[e])throw new Error("Invalid event type: "+e);this._callbacks[e].push(t)}},{key:"emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=!0,o=!1,a=void 0;try{for(var u,s=this._callbacks[e][Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;setTimeout(l.bind.apply(l,[this].concat(n)),0)}}catch(e){o=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}}}]),e}();t.default=o;t.EventEmitterMixin=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(t){function i(){for(var e,t=arguments.length,a=Array(t),u=0;u<t;u++)a[u]=arguments[u];r(this,i);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(a)));if(s._eventEmitter){var l;(l=s._eventEmitter)._registerEventTypes.apply(l,n)}else s._eventEmitter=new(Function.prototype.bind.apply(o,[null].concat(n))),["on","emit"].forEach(function(e){s[e]=function(){var t;return(t=s._eventEmitter)[e].apply(t,arguments)}});return s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e),i}()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n={};return"string"==typeof e&&(e=new Date(e)),t.replace(a,function(t){return n[t]=n[t]||o[t](e)})};var r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=["January","February","March","April","May","June","July","August","September","October","November","December"],o={YYYY:function(e){return e.getFullYear()},YY:function(e){return(""+e.getFullYear()).slice(-2)},MMMM:function(e){return i[e.getMonth()]},MMM:function(e){return i[e.getMonth()].slice(0,3)},MM:function(e){return("0"+(e.getMonth()+1)).slice(-2)},M:function(e){return e.getMonth()+1},DDDD:function(e){return r[e.getDay()]},DDD:function(e){return r[e.getDay()].slice(0,3)},DD:function(e){return("0"+e.getDate()).slice(-2)},D:function(e){return e.getDate()},hh:function(e){return("0"+e.getHour()).slice(-2)},h:function(e){return e.getHour()},mm:function(e){return("0"+e.getMinutes()).slice(-2)},m:function(e){return e.getMinutes()},ss:function(e){return("0"+e.getSeconds()).slice(-2)},s:function(e){return e.getSeconds()}},a=new RegExp(Object.keys(o).sort(function(e,t){return t.length-e.length}).join("|"),"g")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=r(n(3)),a=r(n(7));t.default={load:function(e){for(var t=new o.default(e.size.rows,e.size.cols),n=0;n<t.size;++n){var r=t.squares[n];r.solution=e.grid[n],r.number=e.gridnums[n],e.circles&&e.circles[n]&&(r.shapebg="circle")}for(var a in e.clues){var u=!0,s=!1,l=void 0;try{for(var c,f=e.clues[a][Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value,p=/^(\d+)\.\s(.*)/.exec(h),d=i(p,3),v=d[1],y=d[2];t.addClue(v,a,y)}}catch(e){s=!0,l=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw l}}}return t.meta.title=e.title,t.meta.author=e.author,t.meta.editor=e.editor,t.meta.date=e.date,t.meta.copyright=e.copyright,t},save:function(e){var t={size:{rows:e.rows,cols:e.cols},grid:e.squares.map(function(e){return e.solution}),gridnums:e.squares.map(function(e){return e.number}),circles:e.squares.map(function(e){return"circle"===e.shapebg?1:0}),clues:{},title:e.meta.title,author:e.meta.author,editor:e.meta.editor,date:e.meta.date,copyright:e.meta.copyright};for(var n in e.clues)t.clues[n]=e.clues[n].map(function(e){return e.number+". "+e.text});return t},fetch:function(e){return(0,a.default)(e).then(function(e){return e.json()})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return fetch("https://cors-anywhere.herokuapp.com/"+e,t).then(function(e){if(e.ok)return e;throw new Error("Network response was not ok: "+e.statusText)})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=r(n(24)),a=r(n(7)),u=r(n(3)),s="ACROSS&DOWN\0",l={GEXT:{load:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=e.squares[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;128&t.getUint8(u.idx)&&(u.shapebg="circle")}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}},LTIM:{load:function(e,t){var n=t.getString8(0).split(","),r=i(n,2),o=r[0],a=r[1];e.state.time=+o,e.state.timerIsRunning=!!a}}};t.default={load:function(e){var t=(0,o.default)(e);if(t.getString8(2,12)!==s)throw new Error("Not a puz file");var n=t.getUint8(44),r=t.getUint8(45),i=n*r,a=t.getUint16(46,!0),c=new u.default(r,n),f=52,h=t.getString8(f,i);f+=i;var p=t.getString8(f,i);f+=i;for(var d=0;d<i;++d)c.squares[d].solution=h[d],c.squares[d].letter="-"===p[d]?"":p[d];var v=t.getDelimitedString8(f,0);f+=v.length+1;var y=t.getDelimitedString8(f,0);f+=y.length+1;var g=t.getDelimitedString8(f,0);f+=g.length+1,c.meta.title=v,c.meta.author=y,c.meta.copyright=g;for(var b=[],m=0;m<a;++m){var w=t.getDelimitedString8(f,0);f+=w.length+1,b.push(w)}var z=t.getDelimitedString8(f,0);for(f+=z.length+1,c.meta.notes=z;f+8<t.byteLength;){var _=t.getString8(f,4);f+=_.length;var O=t.getUint16(f,!0);f+=4,function(e,t,n){var r=l[e];r&&r.load&&r.load(t,n)}(_,c,(0,o.default)(e,f,O)),f+=O+1}var k=1,j=0,P=!0,S=!1,x=void 0;try{for(var C,E=c.squares[Symbol.iterator]();!(P=(C=E.next()).done);P=!0){var $=C.value;$.isStart("across")&&(c.addClue(k,"across",b[j++]),$.number=k),$.isStart("down")&&(c.addClue(k,"down",b[j++]),$.number=k),$.number&&++k}}catch(e){S=!0,x=e}finally{try{!P&&E.return&&E.return()}finally{if(S)throw x}}return c},fetch:function(e){return(0,a.default)(e).then(function(e){return e.arrayBuffer()})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(28));t.default=r.default.set({grid:{movement:{newClue:"blank",pauseBeforeSwitch:!0,afterLetter:"next"},keys:{space:"erase"}},cluelist:{scroll:{anchor:"middle",buffer:5}},remote:{letter:{overwrite:!0}}})},function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataView=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e){return e&&e.__esModule?e:{default:e}}(n(1));n(34);var c="<div></div>",f=t.MetadataView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.template,a=void 0===n?c:n,s=r(e,["template"]);return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u({template:a},s)))}return a(t,l.default.View),s(t,[{key:"setHtml",value:function(e){this.$el.html(e),this.$el.show(/\S/.test(this.$el.text()))}}]),t}(),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.view,a=void 0===n?new f:n,s=e.format,l=e.class,c=void 0===l?"metadata":l,h=r(e,["view","format","class"]);i(this,t);var p=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u({view:a},h)));return p.puzzle=null,p.format=s,c&&p.$el.addClass(c),p}return a(t,l.default.Presenter),s(t,[{key:"setFormat",value:function(e){this.formatter=e,this._updateText()}},{key:"setPuzzle",value:function(e){this.puzzle=e,this._update()}},{key:"_update",value:function(){this.puzzle&&this.format?this.view.setHtml(""+this.format(this.puzzle.meta,this.puzzle)):this.view.setHtml("")}}]),t}();t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=r(n(12)),a=r(n(14)),u=r(n(15)),s=r(n(18)),l=r(n(25));n(38),(0,a.default)(["fetch"in window||"fetch","Promise"in window||"Promise","assign"in Object||"Object.assign","keys"in Object||"Object.keys"],function(){function e(e){r.setPuzzle(e),r.show(),document.title=e.meta.title||"Crossword Demo",a.setPuzzle(e)}function t(t){r.hide(),r.loadPuzzle(t).then(e)}function n(e,n,r,i){var o=(0,u.default)(e),a=o.getUrl(n,r,i);if(!a)throw new Error("No puzzle for date: "+n+"-"+r+"-"+i);t({type:o.type,url:a})}var r=new l.default({el:"#puzzle",clues:"horizontal"});r.hide();var a=new s.default;a.on("puzzle",e),a.on("puzzle-state",function(e){return r.setRemoteState(e)});var c=new o.default;c.get("/join-room/:roomId",function(e){var t=e.params.roomId.split("|"),n=i(t,2);!function(e,t){r.hide(),a.setPuzzle(null),a.on("connect",function(){a.puzzle||a.send("request-puzzle")}),a.connect(e,t)}(n[0],n[1])});var f=c.context("/(create-room/:roomId)?",function(e,t,n){e.params.roomId&&a.connect(e.params.roomId),n()});f("puzzle-url/:type/:url(*)",function(e){t({type:e.params.type,url:e.params.url})}),f("puzzle/:source/:year/:month/:day",function(e){var t=e.params;n(t.source,t.year,t.month,t.day)}),f("puzzle/:source/current",function(e){n(e.params.source)}),f("puzzle/:source/:offset(-?[0-9]{1,})",function(e){var t=e.params,r=new Date;r.setDate(r.getDate()+parseInt(t.offset)),n(t.source,r.getFullYear(),r.getMonth()+1,r.getDate())}),c.get("",function(e){return c.navigate("/puzzle/jonesin/current")})})},function(e,t,n){(function(n){(function(r){function i(e){"use strict";var t=this;return this.events={},this.state=null,this.options=e||{},this.options.env=this.options.env||(0===Object.keys(r).length&&n&&!0!==n.browser?"server":"client"),this.options.mode=this.options.mode||("server"!==this.options.env&&this.options.pushState&&r.history&&r.history.pushState?"pushState":"hashchange"),this.version="0.6.4","function"==typeof r.addEventListener&&(r.addEventListener("hashchange",function(){t.trigger("hashchange")}),r.addEventListener("popstate",function(e){if(t.state&&null===t.state.previousState)return!1;t.trigger("navigate")})),this}function o(e,t){this.stack=o.global.slice(0),this.router=e,this.runCallback=!0,this.callbackRan=!1,this.propagateEvent=!0,this.value=e.path();for(var n in t)this[n]=t[n];return this}function a(e){this.route=e,this.keys=[],this.regex=i.regexRoute(e,this.keys)}i.regexRoute=function(e,t,n,r){return e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(r?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,n,r,i,o,a){return t.push({name:i,optional:!!a}),n=n||"",(a?"":n)+"(?:"+(a?n:"")+(r||"")+(o||r&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$",n?"":"i"))},i._forEach=function(e,t){return"function"==typeof Array.prototype.forEach?Array.prototype.forEach.call(e,t):function(e,t){for(var n=0,r=this.length;n<r;++n)e.call(t,this[n],n,this)}.call(e,t)},i.prototype.get=i.prototype.add=function(e){var t=this,n=Array.prototype.slice.call(arguments,1,-1),r=Array.prototype.slice.call(arguments,-1)[0],i=new a(e),u=function(){var a=i.parse(t.path());if(a.match){var u={route:e,params:a.params,req:a,regex:a.match},s=new o(t,u).enqueue(n.concat(r));if(t.trigger("match",s,a),!s.runCallback)return t;if(s.previousState=t.state,t.state=s,s.parent()&&!1===s.parent().propagateEvent)return s.propagateEvent=!1,t;s.callback()}return t},s="pushState"!==t.options.mode&&"server"!==t.options.env?"hashchange":"navigate";return u().on(s,u)},i.prototype.trigger=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return this.events[e]&&i._forEach(this.events[e],function(e){e.apply(t,n)}),this},i.prototype.on=i.prototype.bind=function(e,t){var n=this,r=e.split(" ");return i._forEach(r,function(e){n.events[e]?n.events[e].push(t):n.events[e]=[t]}),this},i.prototype.once=function(e,t){var n=!1;return this.on(e,function(){return!n&&(n=!0,t.apply(this,arguments),t=null,!0)})},i.prototype.context=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){var r=arguments[0],i=arguments.length>2?Array.prototype.slice.call(arguments,1,-1):[],o=Array.prototype.slice.call(arguments,-1)[0],a=("/"!==e.slice(-1)&&"/"!==r&&""!==r?e+"/":e)+("/"!==r.substr(0,1)?r:r.substr(1));return t.add.apply(t,[a].concat(n).concat(i).concat([o]))}},i.prototype.navigate=function(e){return this.path(e).trigger("navigate")},i.prototype.path=function(e){var t,n=this;return"string"==typeof e?("pushState"===n.options.mode?(t=n.options.root?n.options.root+e:e,r.history.pushState({},null,t)):r.location?r.location.hash=(n.options.hashBang?"!":"")+e:r._pathname=e||"",this):void 0===e?t="pushState"===n.options.mode?r.location.pathname.replace(n.options.root,""):"pushState"!==n.options.mode&&r.location?r.location.hash?r.location.hash.split(n.options.hashBang?"#!":"#")[1]:"":r._pathname||"":!1===e?("pushState"===n.options.mode?r.history.pushState({},null,n.options.root||"/"):r.location&&(r.location.hash=n.options.hashBang?"!":""),n):void 0},i.listen=function(){var e,t;return arguments[0]&&arguments[1]?(e=arguments[0],t=arguments[1]):t=arguments[0],function(){for(var e in t)this.add.call(this,e,t[e]);return this}.call(new i(e||{}))},o.global=[],o.prototype.preventDefault=function(){this.runCallback=!1},o.prototype.stopPropagation=function(){this.propagateEvent=!1},o.prototype.parent=function(){return!!!(!this.previousState||!this.previousState.value||this.previousState.value!=this.value)&&this.previousState},o.prototype.callback=function(){this.callbackRan=!0,this.timeStamp=Date.now(),this.next()},o.prototype.enqueue=function(e,t){for(var n=Array.isArray(e)?t<e.length?e.reverse():e:[e];n.length;)this.stack.splice(t||this.stack.length+1,0,n.shift());return this},o.prototype.next=function(){var e=this;return this.stack.shift().call(this.router,this.req,this,function(){e.next.call(e)})},a.prototype.parse=function(e){var t=e.match(this.regex),n=this,r={params:{},keys:this.keys,matches:(t||[]).slice(1),match:t};return i._forEach(r.matches,function(e,t){var i=n.keys[t]&&n.keys[t].name?n.keys[t].name:t;r.params[i]=e?decodeURIComponent(e):void 0}),r},i.CallStack=o,i.Request=a,"function"!=typeof r.define||r.define.amd.grapnel?"object"==typeof e&&"object"==typeof e.exports?e.exports=t=i:r.Grapnel=i:r.define(function(e,t,n){return r.define.amd.grapnel=!0,i})}).call({},"object"==typeof window?window:this)}).call(t,n(13))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(){d&&h&&(d=!1,h.length?p=h.concat(p):v=-1,p.length&&a())}function a(){if(!d){var e=i(o);d=!0;for(var t=p.length;t;){for(h=p,p=[];++v<t;)h&&h[v].run();v=-1,t=p.length}h=null,d=!1,function(e){if(c===clearTimeout)return clearTimeout(e);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}(e)}}function u(e,t){this.fun=e,this.array=t}function s(){}var l,c,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{c="function"==typeof clearTimeout?clearTimeout:r}catch(e){c=r}}();var h,p=[],d=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new u(e,t)),1!==p.length||d||i(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=s,f.addListener=s,f.once=s,f.off=s,f.removeListener=s,f.removeAllListeners=s,f.emit=s,f.prependListener=s,f.prependOnceListener=s,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if((e=e.filter(function(e){return"string"==typeof e})).length)return function(e,t,n){var r=document.createElement("script");r.src=e,r.onload=function(){t()},r.onerror=function(){var t=new Error("Failed to load script "+e);if(!n)throw t;n(t)},document.head.appendChild(r)}("https://cdn.polyfill.io/v2/polyfill.js?features="+e.join(","),t,n);t()}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){var t=a.default[e];if(!t)throw new Error("Unknown source: '"+e+"'");return t};var o=r(n(5)),a=r(n(16)),u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);for(var n in t)this[n]=t[n]}return i(e,[{key:"getUrl",value:function(e,t,n){var r=e?new Date(+e,+t-1,+n):this.mostRecent();if(this.days[r.getDay()])return this.fixDate&&(r=this.fixDate(r)),this.url.replace(/\{\{([^}]+)\}\}/,function(e,t){return(0,o.default)(r,t)})}},{key:"mostRecent",value:function(){for(var e=new Date,t=7;!this.days[e.getDay()]&&--t>0;)e.setDate(e.getDate()-1);return e}}]),e}();for(var s in a.default)a.default[s]=new u(a.default[s])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),o=r(n(17));t.default=i.default.assign({},o.default,{nyt:{url:"https://www.xwordinfo.com/JSON/Data.aspx?date={{MM/DD/YYYY}}",type:"json",days:[!0,!0,!0,!0,!0,!0,!0]}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={jonesin:{url:"http://herbach.dnsalias.com/Jonesin/jz{{YYMMDD}}.puz",type:"puz",days:[!1,!1,!0,!1,!1,!1,!1],fixDate:function(e){return e.setDate(e.getDate()+2),e}},wsj:{url:"http://herbach.dnsalias.com/wsj/wsj{{YYMMDD}}.puz",type:"puz",days:[!1,!1,!1,!1,!1,!1,!0]},wapo:{url:"http://herbach.dnsalias.com/WaPo/wp{{YYMMDD}}.puz",type:"puz",days:[!0,!1,!1,!1,!1,!1,!1]}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(0)),u=n(4),s=r(n(19)),l=r(n(3)),c=!1,f={"request-puzzle":null,puzzle:{send:function(e){return e.puzzle.save("json")},receive:function(e){return l.default.load("json",e)}},"puzzle-state":{send:function(e){return e.puzzle.state}}},h=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.puzzle=null,e.on("connect",function(){return e.registerPuzzleListeners()}),e.on("data",function(t){if(t=JSON.parse(t),c&&console.log("receive",t),t.type in f){var n=(f[t.type]||{}).receive;e.emit(t.type,n?n(t.data):t.data)}else console.log("unknown PuzzlePeer message!",t)}),e.on("request-puzzle",function(){e.puzzle?(e.send("puzzle"),e.send("puzzle-state")):e._puzzleRequested=!0}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.EventEmitterMixin.apply(undefined,[s.default].concat(i(Object.keys(f))))),o(t,[{key:"setPuzzle",value:function(e){this.puzzle=e,this.peer&&this.puzzle&&this.registerPuzzleListeners()}},{key:"registerPuzzleListeners",value:function(){var e=this;if(this.puzzle&&this.peer){var t=a.default.throttle(function(){return e.send("puzzle-state")},100);this.puzzle.on("letter",t),this.puzzle.on("cursor",t),this._puzzleRequested&&(this.send("puzzle"),this._puzzleRequested=!1),this.send("puzzle-state")}}},{key:"send",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(c&&console.log("send",e),!(e in f))throw new Error("Sending unknown event type: "+(e||"(null)"));if(null===n){var r=(f[e]||{}).send;r&&(n=r(this))}(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,JSON.stringify({type:e,data:n}))}}]),t}();t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=r(n(0)),a=r(n(20)),u=r(n(21)),s=r(n(22)),l=r(n(4)),c=function(e){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).reconnect,n=void 0===e||e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"connect","data"));return r.peer=null,r.reconnect=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default),i(t,[{key:"connect",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";this._connecting||(this._connecting=!0,this.peer=null,function(e,t,n){return new Promise(function(n,r){a.default.getItem(f).then(function(i){function l(i,o){var a=new s.default({initiator:o});return a.remoteId=i,a.on("signal",function(n){c.publish({channel:e+"/"+i,message:{user:t,type:"signal",signal:n}})}),a.on("connect",function(){c.stop(),n(a)}),a.on("error",r),a}i||(i=u.default.generateUUID(),a.default.setItem(f,i)),t=t+"@"+i;var c=new u.default({subscribeKey:"sub-c-0f6fdcd4-c8a0-11e7-8c50-5af512f03656",publishKey:"pub-c-ca7b3f31-f860-4fad-b50c-8af521080167",uuid:i,ssl:!0}),h=null,p=0;c.addListener({status:function(n){"PNConnectedCategory"===n.category&&c.publish({channel:e+"/public",message:{user:t,type:"ping"}})},message:function(e){if(o.default.isObject(e.message)&&e.message.user){var n=e.message.user;switch(e.message.type){case"ping":n===t?++p>1&&(console.log("page opened twice! stopping this instance"),c.stop(),r(new Error("Attempt to connect to self"))):h=h||l(n,!0);break;case"signal":if(n===t){console.log("got a signal from ourself... how did this happen?");break}(h=h||l(n,!1)).signal(e.message.signal);break;default:console.log("Unknown message type!",e)}}else console.log("Unknown message format!",e)}}),console.log("Connecting to PubNub as",t),console.log("Subscribing to rooms: ",e+"/public",e+"/"+t),c.subscribe({channels:[e+"/public",e+"/"+t]})}).catch(r)})}(e,n).then(function(r){t.peer=r,console.log("connected to remote peer"),t.peer.on("data",function(e){t.emit("data",e)}),t.emit("connect",r),t.peer.on("close",function(){t.reconnect&&(console.log("peer disconnected -- attempting reconnect"),t._connecting=!1,t.connect(e,n))})}))}},{key:"send",value:function(e){this.peer.send(e)}}]),t}();t.default=c;var f="PubNubPeer.UUID"},function(e,t){e.exports=localforage},function(e,t){e.exports=PubNub},function(e,t){e.exports=SimplePeer},function(e,t,n){function r(e){return n(i(e))}function i(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./json":6,"./json.js":6,"./puz":8,"./puz.js":8};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=23},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=new(Function.prototype.bind.apply(DataView,[null].concat(t)));return r.getString8=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=new Uint8Array(this.buffer,this.byteOffset+e,t);return String.fromCharCode.apply(null,n)},r.getString16=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=new Uint16Array(this.buffer,this.byteOffset+e,t);return String.fromCharCode.apply(null,n)},r.getDelimitedString8=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"string"==typeof t&&(t=t.charCodeAt(0));for(var n=e;n<this.byteLength;++n)if(this.getUint8(n)===t)return this.getString8(e,n-e);return this.getString8(e)},r.getDelimitedString16=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"string"==typeof t&&(t=t.charCodeAt(0));for(var n=e;n<this.byteLength;++n)if(this.getUint16(n)===t)return this.getString16(e,n-e);return this.getString16(e)},r}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PuzzleView=void 0;var s=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=r(n(0)),h=r(n(2)),p=r(n(5)),d=r(n(3)),v=r(n(1)),y=r(n(26)),g=r(n(30)),b=r(n(32)),m=r(n(10)),w=r(n(35));n(37);var z='\n  <div class="puzzle">\n    <div class="puzzle-wrapper">\n      <div class="grid-and-prompt">\n        <div class="prompt" />\n        <div class="grid" />\n      </div>\n      <div class="clues-container" />\n    </div>\n  </div>\n',_=t.PuzzleView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.template,r=void 0===n?z:n,u=i(e,["template"]);o(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l({template:r},u)));return s.$wrapper=s.$(".puzzle-wrapper"),s.$cluesContainer=s.$(".clues-container"),s.$prompt=s.$(".prompt"),s.$grid=s.$(".grid"),s.$gridAndPrompt=s.$(".grid-and-prompt"),s._gridAspect=1,s.handleResize=f.default.throttle(s.handleResize.bind(s),10),(0,h.default)(window).resize(s.handleResize),(0,h.default)(s.handleResize),s}return u(t,v.default.View),c(t,[{key:"addToolbar",value:function(e){this.$el.prepend(e.$el)}},{key:"addGrid",value:function(e){e.appendTo(this.$grid)}},{key:"addPrompt",value:function(e){e.appendTo(this.$prompt)}},{key:"addClueList",value:function(e){e.appendTo(this.$cluesContainer)}},{key:"addMetadata",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"grid";e.$el.addClass("metadata-"+t+"-"+n),"layout"===n?"above"===t?this.$el.prepend(e.$el):this.$el.append(e.$el):e.appendTo(this.$gridAndPrompt)}},{key:"setResponsive",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isResponsive=e}},{key:"isResponsive",value:function(){return this._isResponsive}},{key:"togglePrompt",value:function(e){null==e&&(e=this.$el.hasClass("prompt-off")),this.setExclusiveClass("prompt",e?"on":"off")}},{key:"setLayoutOrientation",value:function(e){this._isLandscape="landscape"===e,this.setExclusiveClass("orientation",e)}},{key:"isLandscape",value:function(){return this._isLandscape}},{key:"isPortrait",value:function(){return!this._isLandscape}},{key:"setGridAspectRatio",value:function(e,t){this._gridAspect=e/t}},{key:"setClueLayout",value:function(e){this.setExclusiveClass("clues",e)}},{key:"show",value:function(){return function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"show",this).call(this),this.handleResize(),this}},{key:"handleResize",value:function(){var e=this.$wrapper.width(),t=this.$wrapper.height();if(!(0===e||0===t||this._lastWidth===e&&this._lastHeight===t)){if(this.isResponsive()&&(this.presenter.onResize(this._lastWidth,this._lastHeight,e,t),this._lastWidth&&this._lastHeight||this.presenter.resizeGrid()),this.isLandscape()){var n=this.$grid.height()*this._gridAspect+(this.$gridAndPrompt.width()-this.$grid.width());this.$gridAndPrompt.css({maxWidth:n,maxHeight:""})}else{var r=this.$grid.width()/this._gridAspect+(this.$gridAndPrompt.height()-this.$grid.height());this.$gridAndPrompt.css({maxWidth:"",maxHeight:r})}this.presenter.resizeGrid(),this._lastWidth=e,this._lastHeight=t}}}]),t}(),O=function(e){var t=e.title,n=e.date,r=e.author,i=e.editor,o=e.copyright;if(!t&&n&&(t=(0,p.default)(n,"<b>DDDD</b>, MMMM D, YYYY")),!i){var a=r.match(/(.*)\/(.*)/)||["",r],u=s(a,3);r=u[1],i=u[2]}return r&&(r="By "+r.replace(/^\s*by\s+/i,"")),i&&(i="Edited by "+i.replace(/^\s*\w*\s*by\s+/i,"")),r=r&&i?r+" ▪ "+i:r||i,o&&!/\u00A9/.test(o)&&(o="© "+o.replace(/^\s*\(c\)\s*/i,"")),'\n    <span class="meta-title">'+(t||"")+'</span>\n    <span class="meta-author">'+(r||"")+'</span>\n    <span class="meta-copyright">'+(o||"")+"</span>\n  "},k=function(e){return{responsive:!0,prompt:!0,clues:"vertical",orientation:"landscape",toolbar:[{html:O,class:"toolbar-puzzle-title"}]}},j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.el,r=e.view,u=void 0===r?new _:r,s=i(e,["el","view"]);o(this,t);var c=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l({view:u,el:n},s)));return c.puzzle=null,c.prompt=new g.default,c.grid=new y.default,c.toolbar=new w.default,c.clues={},c.meta=[],c.view.addToolbar(c.toolbar),c.view.addPrompt(c.prompt.view),c.view.addGrid(c.grid.view),c._config={},c.configure(f.default.assign({},k(c),s)),c}return u(t,v.default.Presenter),c(t,[{key:"setPuzzle",value:function(e){e!==this.puzzle&&(this.puzzle=e,this.prompt.setPuzzle(e),this.toolbar.setPuzzle(e),this._setupClues(),this.meta.forEach(function(t){return t.setPuzzle(e)}),this.view.setGridAspectRatio(e.cols,e.rows),this.grid.setPuzzle(e),this.view.handleResize(),this.puzzle.moveCursor(this.puzzle.currentSquare,this.puzzle.currentOrientation))}},{key:"loadPuzzle",value:function(e){var t=this,n=e.type,r=e.url,i=e.data;return r?d.default.fetch(n,r).then(function(e){return t.setPuzzle(e),e}):new Promise(function(e,r){var o=d.default.load(n,i);t.setPuzzle(o),e(o)})}},{key:"configure",value:function(e){this._configFunctions=this._configFunctions||{responsive:this.setResponsive,prompt:this.togglePrompt,clues:this.setClueLayout,orientation:this.setLayoutOrientation,metadata:this.setMetadata,toolbar:this.configureToolbar};for(var t in e){var n=e[t];if(null!=n){var r=this._configFunctions[t];if(!r)throw new Error("Unknown configuration option '"+t+"'");r.call(this,n),this._config[t]=n}}}},{key:"getConfig",value:function(e){return this._config[e]}},{key:"setResponsive",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.view.setResponsive(e)}},{key:"togglePrompt",value:function(e){this.view.togglePrompt(e)}},{key:"setClueLayout",value:function(e){this.view.setClueLayout(e);var t=!0,n=!1,r=void 0;try{for(var i,o=Object.values(this.clues)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){i.value.setLayout(e)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this._cluesLayout=e}},{key:"setLayoutOrientation",value:function(e){this.view.setLayoutOrientation(e)}},{key:"configureToolbar",value:function(e){this.toolbar.setTools(e)}},{key:"addMetadata",value:function(e){var t=new m.default({format:e.format,class:e.class});t.setPuzzle(this.puzzle),this.view.addMetadata(t.view,e.above?"above":"below",e.above||e.below),this.meta.push(t)}},{key:"setMetadata",value:function(e){var t=this;this.meta.forEach(function(e){return e.remove()}),this.meta=[],e.forEach(function(e){return t.addMetadata(e)})}},{key:"resizeGrid",value:function(){this.grid.view.resizeGrid()}},{key:"setRemoteState",value:function(e){this.puzzle&&this.grid.setRemoteState(e)}},{key:"_setupClues",value:function(){for(var e in this.clues)this.clues[e].remove(),delete this.clues[e];for(var t in this.puzzle.clues){var n=this.clues[t]=new b.default({orientation:t});this._cluesLayout&&n.setLayout(this._cluesLayout),this.view.addClueList(n.view),n.setPuzzle(this.puzzle)}}},{key:"onResize",value:function(e,t,n,r){var i=this;if(this.$el.width()<576)this.configure({orientation:"portrait",clues:"tiny",prompt:!1});else{this.view.isLandscape()?n<r&&this.setLayoutOrientation("portrait"):r<n&&this.setLayoutOrientation("landscape"),f.default.defer(function(){i.view.$el.hasClass("prompt-on")?i.grid.view.getScale()<.75&&(i.togglePrompt(!1),i.resizeGrid()):i.grid.view.getScale()>.9&&(i.togglePrompt(!0),i.resizeGrid())});var o=this.view.$cluesContainer,a=o.width(),u=o.css("min-width").match(/^(.*)px$/)||[],l=s(u,2)[1];a===+l?this.setClueLayout("vertical"):a>2*l?this.setClueLayout("horizontal"):"tiny"===this._cluesLayout&&this.setClueLayout("vertical")}}}]),t}();t.default=j},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GridView=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=r(n(0)),f=r(n(2)),h=r(n(27)),p=r(n(9)),d=r(n(1));n(29);var v="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()_+=-[]{}\\|/?><,`~'\"",y='<div class="puzzle-grid"><table /></div>',g=t.GridView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.template,r=void 0===n?y:n,u=i(e,["template"]);o(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s({template:r},u)));return l.$table=l.$("table"),l.$squares=null,l.rows=0,l.cols=0,l.aspectRatio=1,l.$el.click(function(e){var t=(0,f.default)(e.target),n=t.find(".square");n.length||(n=t.closest(".square"));var r=n.data("idx");return null!=r&&l.presenter.onSquareClick(r)}),l}return u(t,d.default.View),l(t,[{key:"createGrid",value:function(e,t){this.$table.empty(),this.rows=e,this.cols=t,this.aspectRatio=t/e,this.$table.append("\n      "+c.default.range(e).map(function(n){return"\n        <tr> "+c.default.range(t).map(function(t){return'\n          <td>\n            <div class="square" data-idx='+(n*e+t)+'>\n              <div class="solution text" />\n              <div class="user text" />\n              <div class="number" />\n              <div class="decoration" />\n            </div>\n          </td> '}).join("")+"\n        </tr> "}).join("")+"\n    "),this.$squares=this.$el.find(".square"),this.resizeGrid()}},{key:"renderSquare",value:function(e){var t=this.$squares.eq(e.idx);t.parent().toggleClass("blacksquare",e.isBlack),t.children(".number").text(e.number||"").show(e.number>0),t.children(".solution").text(e.solution),t.children(".user").text(e.letter),t.toggleClass("correct",e.isCorrect),e.shapebg?t.children(".decoration").addClass("decoration-"+e.shapebg).show():t.children(".decoration").hide()}},{key:"renderRemoteLetter",value:function(e,t){var n=this.$squares.eq(e),r=n.children(".remote");r.length||(r=(0,f.default)('<div class="text remote">').appendTo(n)),r.text(t||"")}},{key:"renderCursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cursor-highlight";this.$("."+t).removeClass(t),this.$squares.eq(e.idx).parent().addClass(t)}},{key:"renderWordHighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"word-highlight";this.$("."+t).removeClass(t);var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;this.$squares.eq(u.idx).parent().addClass(t)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}},{key:"resizeGrid",value:function(){if(this.rows&&this.cols){var e=this.$table,t=this.$el.parent(),n=t.width(),r=t.height(),i=n-1*(this.cols+1),o=r-1*(this.rows+1);if(this._lastWidth!==i||this.lastHeight!==o){i/o>this.aspectRatio?this._scale=o/(e.height()/(this._scale||1)):this._scale=i/(e.width()/(this._scale||1)),this._scale=+this._scale.toFixed(4),(this._scale<0||isNaN(this._scale))&&(this._scale=.1),e.css({fontSize:this._scale+"em"}),e.css({left:Math.max(0,Math.floor((n-e.width())/2)),top:Math.max(0,Math.floor((r-e.height())/2))}),this._lastWidth=i,this._lastHeight=o}}}},{key:"getScale",value:function(){return this._scale||1}}]),t}(),b=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.view,r=void 0===n?new g:n,u=(e.config,i(e,["view","config"]));o(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s({view:r},u)));return l.puzzle=null,l.bindEvents(),l}return u(t,d.default.Presenter),l(t,[{key:"setPuzzle",value:function(e){var t=this;this.puzzle=e,this.view.createGrid(e.rows,e.cols);var n=!0,r=!1,i=void 0;try{for(var o,a=e.squares[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;this.view.renderSquare(u)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this.puzzle.on("letter",function(e){return t.view.renderSquare(e)}),this.puzzle.on("cursor",function(e,n){t.view.renderCursor(e);var r=t.puzzle.findSquaresInWord(e,n);t.view.renderWordHighlight(r)})}},{key:"onSquareClick",value:function(e){var t=this.puzzle.squares[e];return t.idx===this.puzzle.currentSquare.idx?this.swapOrientation():this.moveCursor(t),!1}},{key:"bindEvents",value:function(){var e=this;this.$el.contextmenu(function(t){return e.swapOrientation()});var t=new h.default;t.bind("right",function(){return e.moveOne("across","next")}),t.bind("left",function(){return e.moveOne("across","prev")}),t.bind("down",function(){return e.moveOne("down","next")}),t.bind("up",function(){return e.moveOne("down","prev")}),t.bind("shift+right",function(){return e.slideOne("across","next")}),t.bind("shift+left",function(){return e.slideOne("across","prev")}),t.bind("shift+down",function(){return e.slideOne("down","next")}),t.bind("shift+up",function(){return e.slideOne("down","prev")}),t.bind("tab",function(){return e.moveOneClue("next")}),t.bind("shift+tab",function(){return e.moveOneClue("prev")}),t.bind("home",function(){return e.moveCursor(e.puzzle.findWordStart("current"))}),t.bind("end",function(){return e.moveCursor(e.puzzle.findWordEnd("current"))});var n=v.split("").concat(v.toLowerCase().split(""));t.bind(n,function(t,n){return e.enterLetter(n.toUpperCase(),"next")}),t.bind("del",function(){return e.enterLetter("")}),t.bind("backspace",function(){return e.enterLetter("","prev")}),t.bind("space",function(){switch(p.default["grid.keys.space"]){case"orientation":return e.swapOrientation();case"erase":default:return e.enterLetter("","next")}})}},{key:"moveCursor",value:function(e,t){return"number"==typeof e&&(e=this.puzzle.squares[e]),e&&e.isWhite&&this.puzzle.moveCursor(e,t),!1}},{key:"moveClue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.puzzle.currentOrientation,n=void 0;switch(p.default["grid.movement.newClue"]){case"start":n=this.puzzle.findWordStart(e,t);break;case"blank":n=this.findBlank(this.puzzle.findWordStart(e,t),t);break;case null:default:n=e}return this.moveCursor(n||e,t)}},{key:"swapOrientation",value:function(){return this.moveCursor(this.puzzle.currentSquare,this.puzzle.oppositeOrientation),!1}},{key:"enterLetter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.puzzle.currentSquare;return n.letter=e,t&&(n=n[t][this.puzzle.currentOrientation],e&&"blank"===p.default["grid.movement.afterLetter"]&&(n=this.findBlank(n)||n),n&&!n.isBlack&&this.moveCursor(n)),!1}},{key:"moveOne",value:function(e,t){var n=this;if(e!==this.puzzle.currentOrientation&&this.puzzle.currentSquare.isEmpty&&p.default["grid.movement.pauseBeforeSwitch"])return this.moveCursor(this.puzzle.currentSquare,e),!1;var r=this.puzzle.findSquare({from:"current",orientation:e,direction:t,test:function(e){return e!==n.puzzle.currentSquare&&e.isWhite}});return this.moveCursor(r,e),!1}},{key:"slideOne",value:function(e,t){var n=this;if(e===this.puzzle.currentOrientation){var r=this.puzzle.findWordStart("current",e);r=this.puzzle.findSquare({from:r,orientation:e,direction:t+"Wrap",test:function(t){return t!==r&&t.isStart(e)}}),this.moveClue(r)}else{var i=this.puzzle.findSquare({from:"current",orientation:e,direction:t,test:function(e){return e!==n.puzzle.currentSquare&&e.isWhite}});this.moveClue(i)}return!1}},{key:"moveOneClue",value:function(e){var t=this.puzzle.currentOrientation,n=this.puzzle.currentClue.idx,r=void 0;return"next"===e?(r=this.puzzle.clues[t][n+1])||(t="across"===t?"down":"across",r=this.puzzle.clues[t][0]):(r=this.puzzle.clues[t][n-1])||(t="across"===t?"down":"across",r=this.puzzle.clues[t].slice(-1)[0]),this.moveClue(r.square,t),!1}},{key:"findBlank",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.puzzle.currentOrientation;return this.puzzle.findSquare({from:e,orientation:t,inWord:!0,test:function(e){return e.isEmpty}})}},{key:"setRemoteState",value:function(e){var t=this.puzzle.squares[e.cursor],n=e.orientation;this.view.renderCursor(t,"remote-cursor-highlight");var r=this.puzzle.findSquaresInWord(t,n);if(this.view.renderWordHighlight(r,"remote-word-highlight"),p.default["remote.letter.overwrite"])for(var i=0;i<e.grid.length;++i)this.puzzle.state.grid[i]!==e.grid[i]&&(this.puzzle.state.grid[i]=e.grid[i],this.view.renderSquare(this.puzzle.squares[i]));else for(var o=0;o<e.grid.length;++o)this.view.renderRemoteLetter(o,e.grid[o])}}]),t}();t.default=b},function(e,t){e.exports=Mousetrap},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"set",value:function(e){var t=[[e,[]]];do{var n=t.pop(),i=r(n,2),a=i[0],u=i[1];for(var s in a){var l=u.concat(s).join("."),c=a[s];o.default.isObject(c)?t.push([c,[l]]):this[l]=c}}while(t.length);return this}},{key:"parse",value:function(e){var t=JSON.parse(e);for(var n in t)this[n]=t[n];return this}},{key:"save",value:function(){return JSON.stringify(this)}}]),e}();t.default=new a},function(e,t){},function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PromptView=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e){return e&&e.__esModule?e:{default:e}}(n(1));n(31);var c='\n  <div class="clue-prompt">\n    <span class="clue-number" />\n    <span class="clue-text" />\n  </div>\n',f=t.PromptView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.template,a=void 0===n?c:n,s=r(e,["template"]);i(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u({template:a},s)));return l.$number=l.$(".clue-number"),l.$text=l.$(".clue-text"),l}return a(t,l.default.View),s(t,[{key:"renderClue",value:function(e){this.$number.html(e.number+e.orientation.slice(0,1).toUpperCase()),this.$text.html(e.text)}}]),t}(),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.view,a=void 0===n?new f:n,s=r(e,["view"]);i(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u({view:a},s)));return l.puzzle=null,l}return a(t,l.default.Presenter),s(t,[{key:"setPuzzle",value:function(e){var t=this;this.puzzle=e,this.puzzle.on("cursor",function(e,n){t.view.renderClue(t.puzzle.currentClue)})}}]),t}();t.default=h},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ClueListView=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=r(n(2)),f=r(n(9)),h=r(n(1));n(33);var p='\n  <div class="clue-list-wrapper">\n    <div class="clue-header" />\n    <ul class="clue-list" />\n  </div>\n',d=t.ClueListView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.template,r=void 0===n?p:n,u=i(e,["template"]);o(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s({template:r},u)));return l.$header=l.$(".clue-header"),l.$list=l.$(".clue-list"),l}return u(t,h.default.View),l(t,[{key:"setLayout",value:function(e){this.setExclusiveClass("clues",e)}},{key:"renderClueList",value:function(e,t){var n=this;this.$el.data("orientation",e),this.$header.text(e),this.$list.empty(),this.$list.append(t.map(function(e){return'\n      <li class="clue" data-idx='+e.idx+'>\n        <span class="clue-number">'+e.number+'</span>\n        <span class="clue-text">'+e.text+"</span>\n      </li>\n    "}));var r=t[t.length-1].number;this.$el.toggleClass("clues-3digit",r>=100),this.$("li.clue").click(function(e){return n.presenter.onClueClick((0,c.default)(e.currentTarget).data("idx"))})}},{key:"renderHighlight",value:function(e,t){this.$el.removeClass("highlight-primary highlight-secondary"),this.$el.find(".highlight").removeClass("highlight"),e&&(this.$el.addClass(t?"highlight-primary":"highlight-secondary"),this.highlightClue(e,"highlight"))}},{key:"highlightClue",value:function(e,t){this.$list.children("li").eq(e.idx).addClass(t)}},{key:"onClueClick",value:function(e){}},{key:"scrollTo",value:function(e){if(!this.hasExclusiveClass("clues","tiny")){var t=this.$list;t.stop(),clearTimeout(this._scrollTimeout),this._scrollTimeout=setTimeout(function(){var n=t.find("li").eq(e.idx),r=n.height(),i=n.offset().top,o=i+r,a=t.offset().top,u=a+t.height(),s=r*f.default["cluelist.scroll.buffer"],l=0;switch(f.default["cluelist.scroll.anchor"]){case"middle":(i<a+s||o>u-s)&&(l=(i+o)/2-(a+u)/2);break;case"top":default:(i<a||o>u-2*s)&&(l=i-a)}l&&t.animate({scrollTop:l+t.scrollTop()})},0)}}}]),t}(),v="vertical",y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.view,r=void 0===n?new d:n,u=(e.config,e.orientation),l=i(e,["view","config","orientation"]);o(this,t);var c=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s({view:r},l)));return c.orientation=u,c.setLayout(v),c.puzzle=null,c}return u(t,h.default.Presenter),l(t,[{key:"setLayout",value:function(e){this.view.setLayout(e)}},{key:"setPuzzle",value:function(e){var t=this;this.puzzle=e,this.view.renderClueList(this.orientation,e.clues[this.orientation]),this.puzzle.on("cursor",function(e){var n=e.clues[t.orientation],r=t.orientation===t.puzzle.currentOrientation;t.view.renderHighlight(n,r),t.view.scrollTo(n)})}},{key:"onClueClick",value:function(e){return this.puzzle.moveCursor(this.puzzle.clues[this.orientation][e].square,this.orientation),!1}}]),t}();t.default=y},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ToolbarView=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=r(n(2)),f=r(n(1)),h=r(n(10));n(36);var p='\n  <div class="puzzle-toolbar">\n  </div>\n',d=t.ToolbarView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.template,r=void 0===n?p:n,u=i(e,["template"]);return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s({template:r},u)))}return u(t,f.default.View),l(t,[{key:"addTool",value:function(e){this.$el.append(e.$el)}}]),t}(),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.view,r=void 0===n?new d:n,u=i(e,["view"]);o(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s({view:r},u)));return l.puzzle=null,l.tools=[],l}return u(t,f.default.Presenter),l(t,[{key:"setPuzzle",value:function(e){this.puzzle=e;var t=!0,n=!1,r=void 0;try{for(var i,o=this.tools[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.setPuzzle&&a.setPuzzle(e)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"setTools",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.view.clear(),this.tools=[];var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.addTool(a)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"addTool",value:function(e){e=this._makeTool(e),this.view.addTool(e.view),this.tools.push(e)}},{key:"_makeTool",value:function(e){var t=this;if(e instanceof f.default.Presenter)return e;var n=void 0;if(n="function"==typeof e.html?new h.default({format:e.html,class:e.class}):new f.default.Presenter({view:new f.default.View({template:y(e)})}),e.items){n.$el.addClass("toolbar-menu"),n.$el.click(function(){return n.$el.toggleClass("toolbar-menu-show"),!1});var r=(0,c.default)('<div class="toolbar-submenu">').appendTo(n.$el),i=!0,o=!1,a=void 0;try{for(var u,s=(e.items||[])[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value,p=this._makeTool(l);r.append(p.$el),this.tools.push(p)}}catch(e){o=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}}var d=function(r){var i=e.events[r];n.$el.on(r,function(){return i(t.puzzle),!1})};for(var v in e.events||{})d(v);return n}}]),t}(),y=function(e){return'\n  <div class="toolbar-tool '+(e.class||"")+'"\n      '+(e.style?'style="'+e.style+'"':"")+"\n      "+(e.label?'title="'+e.label+'"':"")+">\n    <span>"+(e.html||e.label)+"</span>\n  </div>\n"};t.default=v},function(e,t){},function(e,t){},function(e,t){}]);