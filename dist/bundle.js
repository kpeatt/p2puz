!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e){t.exports=jQuery},function(t,e,r){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(){function t(){o(this,t)}return a(t,[{key:"$",value:function(t){return this.$el.find(t)}},{key:"append",value:function(t){return this.$el.append(this._as$(t)),this}},{key:"appendTo",value:function(t){return this.$el.appendTo(this._as$(t)),this}},{key:"clear",value:function(){return this.$el.empty(),this}},{key:"remove",value:function(){return this.$el.remove(),this}},{key:"_as$",value:function(e){return e instanceof t?e.$el:(0,u.default)(e)}}]),t}(),l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.$el=(0,u.default)(t.template||"<div>"),r}return i(e,s),a(e,[{key:"setPresenter",value:function(t){this.presenter=t}},{key:"hide",value:function(){return this.$el.hide(),this}},{key:"show",value:function(){return this.$el.show(),this}},{key:"setExclusiveClass",value:function(t,e){e=e.split(" ").map(function(e){return t+"-"+e}).join(" ");var r="_classes_"+t,n=this[r];if(n!==e)return n&&this.$el.removeClass(n),this.$el.addClass(e),this[r]=e,this}},{key:"hasExclusiveClass",value:function(t,e){e=e.split(" ").map(function(e){return t+"-"+e}).join(" ");var r="_classes_"+t;return new RegExp("(?:^| )"+e+"(?:$| )").test(this[r]||"")}}]),e}(),c=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(!t.view)throw new Error("view is required");return r.view=t.view,r.view.setPresenter(r),t.el&&(0,u.default)(t.el).append(r.$el),r}return i(e,s),a(e,[{key:"hide",value:function(){return this.view.hide(),this}},{key:"show",value:function(){return this.view.show(),this}},{key:"$el",get:function(){return this.view.$el}}]),e}();e.default={View:l,Presenter:c}},function(t,e){t.exports=_},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(r(15)),a={};["puz","json"].forEach(function(t){a[t]=r(16)("./"+t).default});var u=function(t){function e(t,r){n(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"cursor","letter"));return i.rows=t,i.cols=r,i.size=t*r,i.squares=[],i.clues={},i.meta={title:"",author:"",copyright:""},i.state=new c(i),i._initGrid(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"_init",value:function(){if(this._matchCluesAndGrid(),null==this.currentSquare||null==this.currentOrientation){var t=this.currentOrientation||"across",e=this.findSquare({from:this.currentSquare||this.squares[0],orientation:t,test:function(t){return t.isWhite}});this.moveCursor(e,t)}return this}},{key:"addClue",value:function(t,e,r){this.clues[e]||(this.clues[e]=[]),this.clues[e].push(new l(this,this.clues[e].length,t,e,r))}},{key:"save",value:function(t){return a[t].save(this)}},{key:"moveCursor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentOrientation;t&&(this.state.cursor=t.idx,this.state.orientation=e,this.emit("cursor",this.currentSquare,this.currentOrientation))}},{key:"getSquare",value:function(t,e){if(!(t<0||e<0||t>this.lastRow||e>this.lastCol))return this.squares[this.rows*t+e]}},{key:"findSquare",value:function(t){var e=t.test,r=t.from,n=t.orientation,i=void 0===n?this.currentOrientation:n,o=t.direction,a=void 0===o?"next":o,u=t.inWord,s=void 0!==u&&u,l=t.iterate,c=void 0!==l&&l;"current"===r&&(r=this.currentSquare);var f=r;do{if(!f)return;if(s&&!f.isSameWord(r,i))return;if(e(f,i,a)&&!c)return f;f=f[a][i]}while(f!==r)}},{key:"forEachSquare",value:function(t,e){t.from=t.from||this.squares[0],t.direction=(t.direction||"next")+"Wrap",t.iterate=!0,t.test=t.test||e,this.findSquare(t)}},{key:"findWordStart",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentOrientation;if("current"===t&&(t=this.currentSquare),t)return t.clues[e].square}},{key:"findWordEnd",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentOrientation;return this.findSquare({from:t,orientation:e,test:function(t){return t.isEnd(e)}})}},{key:"findSquaresInWord",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentOrientation,r=[];return this.forEachSquare({from:this.findWordStart(t,e),orientation:e,inWord:!0,test:function(t){return r.push(t)}}),r}},{key:"_initGrid",value:function(){for(var t=0;t<this.rows;++t)for(var e=0;e<this.cols;++e){var r=t*this.rows+e;this.squares.push(new s(this,t,e,r,"",0))}var n=!0,i=!1,o=void 0;try{for(var a,u=this.squares[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var l=a.value;l.prev={across:this.getSquare(l.row,l.col-1),down:this.getSquare(l.row-1,l.col)},l.next={across:this.getSquare(l.row,l.col+1),down:this.getSquare(l.row+1,l.col)},l.prevWrap={across:l.prev.across||this.getSquare(l.row-1,this.lastCol),down:l.prev.down||this.getSquare(this.lastRow,l.col-1)},l.nextWrap={across:l.next.across||this.getSquare(l.row+1,0),down:l.next.down||this.getSquare(0,l.col+1)}}}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}}},{key:"_matchCluesAndGrid",value:function(){var t=this,e={};for(var r in this.clues){e[r]={};var n=!0,i=!1,o=void 0;try{for(var a,u=this.clues[r][Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var s=a.value;e[r][s.number]=s}}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}}var l=null;["across","down"].forEach(function(r){t.forEachSquare({orientation:r},function(t){var n=e[r][t.number];(!l||t.number!==l.number&&n)&&(l=n)&&(l.square=t),t.clues[r]=t.isWhite?l:null})})}},{key:"currentSquare",get:function(){return this.squares[this.state.cursor]}},{key:"currentOrientation",get:function(){return this.state.orientation}},{key:"oppositeOrientation",get:function(){return"across"===this.state.orientation?"down":"across"}},{key:"currentClue",get:function(){return this.currentSquare.clues[this.currentOrientation]}},{key:"oppositeClue",get:function(){return this.currentSquare.clues[this.oppositeOrientation]}},{key:"lastCol",get:function(){return this.cols-1}},{key:"lastRow",get:function(){return this.cols-1}}],[{key:"load",value:function(t,e){var r=a[t].load(e);if(r)return r._init()}},{key:"fetch",value:function(t,r){return Promise.resolve(a[t].fetch(r)).then(function(r){return e.load(t,r)})}}]),e}();e.default=u;var s=function(){function t(e,r,i,o,a,u){n(this,t),this.puzzle=e,this.row=r,this.col=i,this.idx=o,this.solution=a,this.number=u,this.prev=null,this.next=null,this.prevWrap=null,this.nextWrap=null,this.shapebg=null,this.clues={}}return i(t,[{key:"isStart",value:function(t){return!this.isBlack&&(!this.prev[t]||this.prev[t].isBlack)}},{key:"isEnd",value:function(t){return!this.isBlack&&(!this.next[t]||this.next[t].isBlack)}},{key:"isSameWord",value:function(t,e){return this.clues[e]===t.clues[e]}},{key:"letter",get:function(){return this.puzzle.state.grid[this.idx]||""},set:function(t){this.puzzle.state.grid[this.idx]=t,this.puzzle.emit("letter",this,t)}},{key:"isBlack",get:function(){return"."===this.solution}},{key:"isWhite",get:function(){return!this.isBlack}},{key:"isEmpty",get:function(){return!this.isBlack&&""===this.letter}},{key:"isCorrect",get:function(){return this.solution===this.letter}}]),t}(),l=function t(e,r,i,o,a){n(this,t),this.idx=r,this.number=i,this.orientation=o,this.text=a,this.square=null},c=function t(e){n(this,t),this.cursor=null,this.orientation=null,this.grid=e.squares.map(function(t){return""})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var r={};return"string"==typeof t&&(t=new Date(t)),e.replace(a,function(e){return r[e]=r[e]||o[e](t)})};var n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=["January","February","March","April","May","June","July","August","September","October","November","December"],o={YYYY:function(t){return t.getFullYear()},YY:function(t){return(""+t.getFullYear()).slice(-2)},MMMM:function(t){return i[t.getMonth()]},MMM:function(t){return i[t.getMonth()].slice(0,3)},MM:function(t){return("0"+(t.getMonth()+1)).slice(-2)},M:function(t){return t.getMonth()+1},DDDD:function(t){return n[t.getDay()]},DDD:function(t){return n[t.getDay()].slice(0,3)},DD:function(t){return("0"+t.getDate()).slice(-2)},D:function(t){return t.getDate()},hh:function(t){return("0"+t.getHour()).slice(-2)},h:function(t){return t.getHour()},mm:function(t){return("0"+t.getMinutes()).slice(-2)},m:function(t){return t.getMinutes()},ss:function(t){return("0"+t.getSeconds()).slice(-2)},s:function(t){return t.getSeconds()}},a=new RegExp(Object.keys(o).sort(function(t,e){return e.length-t.length}).join("|"),"g")},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(r(0)),a=n(r(3));e.default={load:function(t){for(var e=new a.default(t.size.rows,t.size.cols),r=0;r<e.size;++r){var n=e.squares[r];n.solution=t.grid[r],n.number=t.gridnums[r],t.circles&&t.circles[r]&&(n.shapebg="circle")}for(var o in t.clues){var u=!0,s=!1,l=void 0;try{for(var c,f=t.clues[o][Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value,p=/^(\d+)\.\s(.*)/.exec(h),d=i(p,3),v=d[1],y=d[2];e.addClue(v,o,y)}}catch(t){s=!0,l=t}finally{try{!u&&f.return&&f.return()}finally{if(s)throw l}}}return e.meta.title=t.title,e.meta.author=t.author,e.meta.editor=t.editor,e.meta.date=t.date,e.meta.copyright=t.copyright,e},save:function(t){var e={size:{rows:t.rows,cols:t.cols},grid:t.squares.map(function(t){return t.solution}),gridnums:t.squares.map(function(t){return t.number}),circles:t.squares.map(function(t){return"circle"===t.shapebg?1:0}),clues:{},title:t.meta.title,author:t.meta.author,editor:t.meta.editor,date:t.meta.date,copyright:t.meta.copyright};for(var r in t.clues)e.clues[r]=t.clues[r].map(function(t){return t.number+". "+t.text});return e},fetch:o.default.getJSON}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(r(17)),a=n(r(18)),u=n(r(3)),s="ACROSS&DOWN\0",l={GEXT:{load:function(t,e){var r=!0,n=!1,i=void 0;try{for(var o,a=t.squares[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var u=o.value;128&e.getUint8(u.idx)&&(u.shapebg="circle")}}catch(t){n=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}}},LTIM:{load:function(t,e){var r=e.getString8(0).split(","),n=i(r,2),o=n[0],a=n[1];t.state.time=+o,t.state.timerIsRunning=!!a}}};e.default={load:function(t){var e=(0,o.default)(t);if(e.getString8(2,12)!==s)throw new Error("Not a puz file");var r=e.getUint8(44),n=e.getUint8(45),i=r*n,a=e.getUint16(46,!0),c=new u.default(n,r),f=52,h=e.getString8(f,i);f+=i;var p=e.getString8(f,i);f+=i;for(var d=0;d<i;++d)c.squares[d].solution=h[d],c.squares[d].letter="-"===p[d]?"":p[d];var v=e.getDelimitedString8(f,0);f+=v.length+1;var y=e.getDelimitedString8(f,0);f+=y.length+1;var g=e.getDelimitedString8(f,0);f+=g.length+1,c.meta.title=v,c.meta.author=y,c.meta.copyright=g;for(var m=[],b=0;b<a;++b){var w=e.getDelimitedString8(f,0);f+=w.length+1,m.push(w)}var _=e.getDelimitedString8(f,0);for(f+=_.length+1,c.meta.notes=_;f+8<e.byteLength;){var z=e.getString8(f,4);f+=z.length;var O=e.getUint16(f,!0);f+=4,function(t,e,r){var n=l[t];n&&n.load&&n.load(e,r)}(z,c,(0,o.default)(t,f,O)),f+=O+1}var k=1,S=0,j=!0,C=!1,x=void 0;try{for(var P,E=c.squares[Symbol.iterator]();!(j=(P=E.next()).done);j=!0){var $=P.value;$.isStart("across")&&(c.addClue(k,"across",m[S++]),$.number=k),$.isStart("down")&&(c.addClue(k,"down",m[S++]),$.number=k),$.number&&++k}}catch(t){C=!0,x=t}finally{try{!j&&E.return&&E.return()}finally{if(C)throw x}}return c},fetch:function(t){return(0,a.default)({url:t,arraybuffer:!0})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(22));e.default=n.default.set({grid:{movement:{newClue:"blank",pauseBeforeSwitch:!0,afterLetter:"next"},keys:{space:"erase"}},cluelist:{scroll:{anchor:"middle",buffer:5}},remote:{letter:{overwrite:!0}}})},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var i=n(r(9)),o=n(r(11)),a=n(r(12)),u=n(r(14));r(31),(0,o.default)(["Promise"in window||"Promise","assign"in Object||"Object.assign","keys"in Object||"Object.keys"],function(){function t(t){r.loadPuzzle(t).then(function(t){r.show(),document.title=t.meta.title||"Crossword Demo"})}function e(e,r,n,i){var o=(0,a.default)(e),u=o.getUrl(r,n,i);if(!u)throw new Error("No puzzle for date: "+r+"-"+n+"-"+i);t({type:o.type,url:u})}var r=new u.default({el:"#puzzle",clues:"horizontal"});r.hide();var n=new i.default;n.get(/puzzle-url\/([^/]+)\/(\w+:\/+.*)/,function(e){t({type:e.params[0],url:e.params[1]})}),n.get("puzzle/:source/:year/:month/:day",function(t){var r=t.params;e(r.source,r.year,r.month,r.day)}),n.get("puzzle/:source/current",function(t){e(t.params.source)}),n.get("",function(t){return n.navigate("puzzle/jonesin/current")})})},function(t,e,r){(function(r){(function(n){function i(t){"use strict";var e=this;return this.events={},this.state=null,this.options=t||{},this.options.env=this.options.env||(0===Object.keys(n).length&&r&&!0!==r.browser?"server":"client"),this.options.mode=this.options.mode||("server"!==this.options.env&&this.options.pushState&&n.history&&n.history.pushState?"pushState":"hashchange"),this.version="0.6.4","function"==typeof n.addEventListener&&(n.addEventListener("hashchange",function(){e.trigger("hashchange")}),n.addEventListener("popstate",function(t){if(e.state&&null===e.state.previousState)return!1;e.trigger("navigate")})),this}function o(t,e){this.stack=o.global.slice(0),this.router=t,this.runCallback=!0,this.callbackRan=!1,this.propagateEvent=!0,this.value=t.path();for(var r in e)this[r]=e[r];return this}function a(t){this.route=t,this.keys=[],this.regex=i.regexRoute(t,this.keys)}i.regexRoute=function(t,e,r,n){return t instanceof RegExp?t:(t instanceof Array&&(t="("+t.join("|")+")"),t=t.concat(n?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(t,r,n,i,o,a){return e.push({name:i,optional:!!a}),r=r||"",(a?"":r)+"(?:"+(a?r:"")+(n||"")+(o||n&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+t+"$",r?"":"i"))},i._forEach=function(t,e){return"function"==typeof Array.prototype.forEach?Array.prototype.forEach.call(t,e):function(t,e){for(var r=0,n=this.length;r<n;++r)t.call(e,this[r],r,this)}.call(t,e)},i.prototype.get=i.prototype.add=function(t){var e=this,r=Array.prototype.slice.call(arguments,1,-1),n=Array.prototype.slice.call(arguments,-1)[0],i=new a(t),u=function(){var a=i.parse(e.path());if(a.match){var u={route:t,params:a.params,req:a,regex:a.match},s=new o(e,u).enqueue(r.concat(n));if(e.trigger("match",s,a),!s.runCallback)return e;if(s.previousState=e.state,e.state=s,s.parent()&&!1===s.parent().propagateEvent)return s.propagateEvent=!1,e;s.callback()}return e},s="pushState"!==e.options.mode&&"server"!==e.options.env?"hashchange":"navigate";return u().on(s,u)},i.prototype.trigger=function(t){var e=this,r=Array.prototype.slice.call(arguments,1);return this.events[t]&&i._forEach(this.events[t],function(t){t.apply(e,r)}),this},i.prototype.on=i.prototype.bind=function(t,e){var r=this,n=t.split(" ");return i._forEach(n,function(t){r.events[t]?r.events[t].push(e):r.events[t]=[e]}),this},i.prototype.once=function(t,e){var r=!1;return this.on(t,function(){return!r&&(r=!0,e.apply(this,arguments),e=null,!0)})},i.prototype.context=function(t){var e=this,r=Array.prototype.slice.call(arguments,1);return function(){var n=arguments[0],i=arguments.length>2?Array.prototype.slice.call(arguments,1,-1):[],o=Array.prototype.slice.call(arguments,-1)[0],a=("/"!==t.slice(-1)&&"/"!==n&&""!==n?t+"/":t)+("/"!==n.substr(0,1)?n:n.substr(1));return e.add.apply(e,[a].concat(r).concat(i).concat([o]))}},i.prototype.navigate=function(t){return this.path(t).trigger("navigate")},i.prototype.path=function(t){var e,r=this;return"string"==typeof t?("pushState"===r.options.mode?(e=r.options.root?r.options.root+t:t,n.history.pushState({},null,e)):n.location?n.location.hash=(r.options.hashBang?"!":"")+t:n._pathname=t||"",this):void 0===t?e="pushState"===r.options.mode?n.location.pathname.replace(r.options.root,""):"pushState"!==r.options.mode&&n.location?n.location.hash?n.location.hash.split(r.options.hashBang?"#!":"#")[1]:"":n._pathname||"":!1===t?("pushState"===r.options.mode?n.history.pushState({},null,r.options.root||"/"):n.location&&(n.location.hash=r.options.hashBang?"!":""),r):void 0},i.listen=function(){var t,e;return arguments[0]&&arguments[1]?(t=arguments[0],e=arguments[1]):e=arguments[0],function(){for(var t in e)this.add.call(this,t,e[t]);return this}.call(new i(t||{}))},o.global=[],o.prototype.preventDefault=function(){this.runCallback=!1},o.prototype.stopPropagation=function(){this.propagateEvent=!1},o.prototype.parent=function(){return!!!(!this.previousState||!this.previousState.value||this.previousState.value!=this.value)&&this.previousState},o.prototype.callback=function(){this.callbackRan=!0,this.timeStamp=Date.now(),this.next()},o.prototype.enqueue=function(t,e){for(var r=Array.isArray(t)?e<t.length?t.reverse():t:[t];r.length;)this.stack.splice(e||this.stack.length+1,0,r.shift());return this},o.prototype.next=function(){var t=this;return this.stack.shift().call(this.router,this.req,this,function(){t.next.call(t)})},a.prototype.parse=function(t){var e=t.match(this.regex),r=this,n={params:{},keys:this.keys,matches:(e||[]).slice(1),match:e};return i._forEach(n.matches,function(t,e){var i=r.keys[e]&&r.keys[e].name?r.keys[e].name:e;n.params[i]=t?decodeURIComponent(t):void 0}),n},i.CallStack=o,i.Request=a,"function"!=typeof n.define||n.define.amd.grapnel?"object"==typeof t&&"object"==typeof t.exports?t.exports=e=i:n.Grapnel=i:n.define(function(t,e,r){return n.define.amd.grapnel=!0,i})}).call({},"object"==typeof window?window:this)}).call(e,r(10))},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(l===setTimeout)return setTimeout(t,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function o(){d&&h&&(d=!1,h.length?p=h.concat(p):v=-1,p.length&&a())}function a(){if(!d){var t=i(o);d=!0;for(var e=p.length;e;){for(h=p,p=[];++v<e;)h&&h[v].run();v=-1,e=p.length}h=null,d=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function u(t,e){this.fun=t,this.array=e}function s(){}var l,c,f=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(t){l=r}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(t){c=n}}();var h,p=[],d=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];p.push(new u(t,e)),1!==p.length||d||i(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=s,f.addListener=s,f.once=s,f.off=s,f.removeListener=s,f.removeAllListeners=s,f.emit=s,f.prependListener=s,f.prependOnceListener=s,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){if((t=t.filter(function(t){return"string"==typeof t})).length)return function(t,e,r){var n=document.createElement("script");n.src=t,n.onload=function(){e()},n.onerror=function(){var e=new Error("Failed to load script "+t);if(!r)throw e;r(e)},document.head.appendChild(n)}("https://cdn.polyfill.io/v2/polyfill.js?features="+t.join(","),e,r);e()}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();e.default=function(t){var e=a.default[t];if(!e)throw new Error("Unknown source: '"+t+"'");return e};var o=n(r(4)),a=n(r(13)),u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r in e)this[r]=e[r]}return i(t,[{key:"getUrl",value:function(t,e,r){var n=t?new Date(+t,+e-1,+r):this.mostRecent();if(this.days[n.getDay()])return this.fixDate&&(n=this.fixDate(n)),this.url.replace(/\{\{([^}]+)\}\}/,function(t,e){return(0,o.default)(n,e)})}},{key:"mostRecent",value:function(){for(var t=new Date,e=7;!this.days[t.getDay()]&&--e>0;)t.setDate(t.getDate()-1);return t}}]),t}();for(var s in a.default)a.default[s]=new u(a.default[s])},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={jonesin:{url:"http://herbach.dnsalias.com/Jonesin/jz{{YYMMDD}}.puz",type:"puz",days:[!1,!1,!0,!1,!1,!1,!1],fixDate:function(t){return t.setDate(t.getDate()+2),t}},wsj:{url:"http://herbach.dnsalias.com/wsj/wsj{{YYMMDD}}.puz",type:"puz",days:[!1,!1,!1,!1,!1,!1,!0]},wapo:{url:"http://herbach.dnsalias.com/WaPo/wp{{YYMMDD}}.puz",type:"puz",days:[!0,!1,!1,!1,!1,!1,!1]}}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.PuzzleView=void 0;var s=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},c=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),f=n(r(2)),h=n(r(0)),p=n(r(4)),d=n(r(3)),v=n(r(1)),y=n(r(20)),g=n(r(24)),m=n(r(26)),b=n(r(28));r(30);var w='\n  <div class="puzzle">\n    <div class="puzzle-wrapper">\n      <div class="grid-and-prompt">\n        <div class="prompt" />\n        <div class="grid" />\n      </div>\n      <div class="clues-container" />\n    </div>\n  </div>\n',_=e.PuzzleView=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.template,n=void 0===r?w:r,u=i(t,["template"]);o(this,e);var s=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,l({template:n},u)));return s.$wrapper=s.$(".puzzle-wrapper"),s.$cluesContainer=s.$(".clues-container"),s.$prompt=s.$(".prompt"),s.$grid=s.$(".grid"),s.$gridAndPrompt=s.$(".grid-and-prompt"),s._gridAspect=1,s.handleResize=f.default.throttle(s.handleResize.bind(s),10),(0,h.default)(window).resize(s.handleResize),(0,h.default)(s.handleResize),s}return u(e,v.default.View),c(e,[{key:"addGrid",value:function(t){t.appendTo(this.$grid)}},{key:"addPrompt",value:function(t){t.appendTo(this.$prompt)}},{key:"addClueList",value:function(t){t.appendTo(this.$cluesContainer)}},{key:"addMetadata",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"grid";t.$el.addClass("metadata-"+e+"-"+r),"layout"===r?"above"===e?this.$el.prepend(t.$el):this.$el.append(t.$el):t.appendTo(this.$gridAndPrompt)}},{key:"setResponsive",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isResponsive=t}},{key:"isResponsive",value:function(){return this._isResponsive}},{key:"togglePrompt",value:function(t){null==t&&(t=this.$el.hasClass("prompt-off")),this.setExclusiveClass("prompt",t?"on":"off")}},{key:"setLayoutOrientation",value:function(t){this._isLandscape="landscape"===t,this.setExclusiveClass("orientation",t)}},{key:"isLandscape",value:function(){return this._isLandscape}},{key:"isPortrait",value:function(){return!this._isLandscape}},{key:"setGridAspectRatio",value:function(t,e){this._gridAspect=t/e}},{key:"setClueLayout",value:function(t){this.setExclusiveClass("clues",t)}},{key:"show",value:function(){return function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this),this.handleResize(),this}},{key:"handleResize",value:function(){var t=this.$wrapper.width(),e=this.$wrapper.height();if(!(0===t||0===e||this._lastWidth===t&&this._lastHeight===e)){if(this.isResponsive()&&(this.presenter.onResize(this._lastWidth,this._lastHeight,t,e),this._lastWidth&&this._lastHeight||this.presenter.resizeGrid()),this.isLandscape()){var r=this.$grid.height()*this._gridAspect+(this.$gridAndPrompt.width()-this.$grid.width());this.$gridAndPrompt.css({maxWidth:r,maxHeight:""})}else{var n=this.$grid.width()/this._gridAspect+(this.$gridAndPrompt.height()-this.$grid.height());this.$gridAndPrompt.css({maxWidth:"",maxHeight:n})}this.presenter.resizeGrid(),this._lastWidth=t,this._lastHeight=e}}}]),e}(),z={responsive:!0,prompt:!0,clues:"vertical",orientation:"landscape",metadata:[{below:"grid",class:"meta-title",format:function(t){var e=t.title,r=t.date;return e||(r?(0,p.default)(r,"<b>DDDD</b>, MMMM D, YYYY"):void 0)}},{below:"grid",class:"meta-byline",format:function(t){var e=t.author,r=t.editor,n=t.copyright;if(!r){var i=e.match(/(.*)\/(.*)/)||["",e],o=s(i,3);e=o[1],r=o[2]}return e&&(e="By "+e.replace(/^\s*by\s+/i,"")),r&&(r="Edited by "+r.replace(/^\s*\w*\s*by\s+/i,"")),e=e&&r?e+" ▪ "+r:e||r,n&&!/\u00A9/.test(n)&&(n="© "+n.replace(/^\s*\(c\)\s*/i,"")),'\n    <span class="meta-author">'+(e||"")+'</span>\n    <span class="meta-copyright">'+(n||"")+"</span>\n  "}}]},O=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.el,n=t.view,u=void 0===n?new _:n,s=i(t,["el","view"]);o(this,e);var c=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,l({view:u,el:r},s)));return c.puzzle=null,c.prompt=new g.default,c.grid=new y.default,c.clues={},c.meta=[],c.view.addPrompt(c.prompt.view),c.view.addGrid(c.grid.view),c._config={},c.configure(f.default.assign({},z,s)),c}return u(e,v.default.Presenter),c(e,[{key:"setPuzzle",value:function(t){this.puzzle=t,this.prompt.setPuzzle(t),this._setupClues(),this.meta.forEach(function(e){return e.setPuzzle(t)}),this.view.setGridAspectRatio(t.cols,t.rows),this.grid.setPuzzle(t),this.view.handleResize(),this.puzzle.moveCursor(this.puzzle.currentSquare,this.puzzle.currentOrientation)}},{key:"loadPuzzle",value:function(t){var e=this,r=t.type,n=t.url,i=t.data;return n?d.default.fetch(r,n).then(function(t){return e.setPuzzle(t),t}):new Promise(function(t,n){var o=d.default.load(r,i);e.setPuzzle(o),t(o)})}},{key:"configure",value:function(t){this._configFunctions=this._configFunctions||{responsive:this.setResponsive,prompt:this.togglePrompt,clues:this.setClueLayout,orientation:this.setLayoutOrientation,metadata:this.setMetadata};for(var e in t){var r=t[e];if(null!=r){var n=this._configFunctions[e];if(!n)throw new Error("Unknown configuration option '"+e+"'");n.call(this,r),this._config[e]=r}}}},{key:"getConfig",value:function(t){return this._config[t]}},{key:"setResponsive",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.view.setResponsive(t)}},{key:"togglePrompt",value:function(t){this.view.togglePrompt(t)}},{key:"setClueLayout",value:function(t){this.view.setClueLayout(t);var e=!0,r=!1,n=void 0;try{for(var i,o=Object.values(this.clues)[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.setLayout(t)}}catch(t){r=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}this._cluesLayout=t}},{key:"setLayoutOrientation",value:function(t){this.view.setLayoutOrientation(t)}},{key:"addMetadata",value:function(t){var e=new b.default({format:t.format});t.class&&e.$el.addClass(t.class),e.setPuzzle(this.puzzle),this.view.addMetadata(e.view,t.above?"above":"below",t.above||t.below),this.meta.push(e)}},{key:"setMetadata",value:function(t){var e=this;this.meta.forEach(function(t){return t.remove()}),this.meta=[],t.forEach(function(t){return e.addMetadata(t)})}},{key:"resizeGrid",value:function(){this.grid.view.resizeGrid()}},{key:"setRemoteState",value:function(t){console.log("remote state",t),this.grid.setRemoteState(t)}},{key:"_setupClues",value:function(){for(var t in this.clues)this.clues[t].remove(),delete this.clues[t];for(var e in this.puzzle.clues){var r=this.clues[e]=new m.default({orientation:e});this._cluesLayout&&r.setLayout(this._cluesLayout),this.view.addClueList(r.view),r.setPuzzle(this.puzzle)}}},{key:"onResize",value:function(t,e,r,n){var i=this;if(this.$el.width()<576)this.configure({orientation:"portrait",clues:"tiny",prompt:!1});else{this.view.isLandscape()?r<n&&this.setLayoutOrientation("portrait"):n<r&&this.setLayoutOrientation("landscape"),f.default.defer(function(){i.view.$el.hasClass("prompt-on")?i.grid.view.getScale()<.75&&(i.togglePrompt(!1),i.resizeGrid()):i.grid.view.getScale()>.9&&(i.togglePrompt(!0),i.resizeGrid())});var o=this.view.$cluesContainer,a=o.width(),u=o.css("min-width").match(/^(.*)px$/)||[],l=s(u,2)[1];a===+l?this.setClueLayout("vertical"):a>2*l?this.setClueLayout("horizontal"):"tiny"===this._cluesLayout&&this.setClueLayout("vertical")}}}]),e}();e.default=O},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(){n(this,t),this._eventEmitter=this,this._registerEventTypes.apply(this,arguments)}return i(t,[{key:"_registerEventTypes",value:function(){this._callbacks||(this._callbacks={});for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var s=a.value;this._callbacks[s]||(this._callbacks[s]=[])}}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}}},{key:"on",value:function(t,e){if(!this._callbacks[t])throw new Error("Invalid event type: "+t);this._callbacks[t].push(e)}},{key:"emit",value:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=!0,o=!1,a=void 0;try{for(var u,s=this._callbacks[t][Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;setTimeout(l.bind.apply(l,[this].concat(r)),0)}}catch(t){o=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}}}]),t}();e.default=o;e.EventEmitterMixin=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return function(e){function i(){for(var t,e=arguments.length,a=Array(e),u=0;u<e;u++)a[u]=arguments[u];n(this,i);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(a)));if(s._eventEmitter){var l;(l=s._eventEmitter)._registerEventTypes.apply(l,r)}else s._eventEmitter=new(Function.prototype.bind.apply(o,[null].concat(r))),["on","emit"].forEach(function(t){s[t]=function(){var e;return(e=s._eventEmitter)[t].apply(e,arguments)}});return s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,t),i}()}},function(t,e,r){function n(t){return r(i(t))}function i(t){var e=o[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var o={"./json":5,"./json.js":5,"./puz":6,"./puz.js":6};n.keys=function(){return Object.keys(o)},n.resolve=i,t.exports=n,n.id=16},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=new(Function.prototype.bind.apply(DataView,[null].concat(e)));return n.getString8=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,r=new Uint8Array(this.buffer,this.byteOffset+t,e);return String.fromCharCode.apply(null,r)},n.getString16=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,r=new Uint16Array(this.buffer,this.byteOffset+t,e);return String.fromCharCode.apply(null,r)},n.getDelimitedString8=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"string"==typeof e&&(e=e.charCodeAt(0));for(var r=t;r<this.byteLength;++r)if(this.getUint8(r)===e)return this.getString8(t,r-t);return this.getString8(t)},n.getDelimitedString16=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"string"==typeof e&&(e=e.charCodeAt(0));for(var r=t;r<this.byteLength;++r)if(this.getUint16(r)===e)return this.getString16(t,r-t);return this.getString16(t)},n}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){"string"==typeof t&&(t={url:t}),t.method=t.method||"GET",t.callback=t.callback||"_fetch_proxy_callback_",t.url=t.url.replace("callback=?","callback="+t.callback);var e=t.arraybuffer;delete t.arraybuffer,e&&(t.encoding="base64");var r="http://api.jsonp.net/?"+encodeURIComponent(JSON.stringify(t));return i.default.ajax({url:r,dataType:"jsonp",jsonp:!1,cache:!0,jsonpCallback:t.callback}).then(function(r){return r=r.body,/callback=/.test(t.url)&&(r=r.slice(t.callback.length+1,-1)),e?o.default.decode(r):r})};var i=n(r(0)),o=n(r(19))},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<t.length;n++)r[t.charCodeAt(n)]=n;e.encode=function(e){var r,n=new Uint8Array(e),i=n.length,o="";for(r=0;r<i;r+=3)o+=t[n[r]>>2],o+=t[(3&n[r])<<4|n[r+1]>>4],o+=t[(15&n[r+1])<<2|n[r+2]>>6],o+=t[63&n[r+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(t){var e,n,i,o,a,u=.75*t.length,s=t.length,l=0;"="===t[t.length-1]&&(u--,"="===t[t.length-2]&&u--);var c=new ArrayBuffer(u),f=new Uint8Array(c);for(e=0;e<s;e+=4)n=r[t.charCodeAt(e)],i=r[t.charCodeAt(e+1)],o=r[t.charCodeAt(e+2)],a=r[t.charCodeAt(e+3)],f[l++]=n<<2|i>>4,f[l++]=(15&i)<<4|o>>2,f[l++]=(3&o)<<6|63&a;return c}}()},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.GridView=void 0;var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},l=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),c=n(r(2)),f=n(r(0)),h=n(r(21)),p=n(r(7)),d=n(r(1));r(23);var v="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()_+=-[]{}\\|/?><,`~'\"",y='<div class="puzzle-grid"><table /></div>',g=e.GridView=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.template,n=void 0===r?y:r,u=i(t,["template"]);o(this,e);var l=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s({template:n},u)));return l.$table=l.$("table"),l.$squares=null,l.rows=0,l.cols=0,l.aspectRatio=1,l}return u(e,d.default.View),l(e,[{key:"createGrid",value:function(t,e){var r=this;this.$table.empty(),this.rows=t,this.cols=e,this.aspectRatio=e/t,this.$table.append("\n      "+c.default.range(t).map(function(r){return"\n        <tr> "+c.default.range(e).map(function(e){return'\n          <td>\n            <div class="square" data-idx='+(r*t+e)+'>\n              <div class="solution text" />\n              <div class="user text" />\n              <div class="number" />\n              <div class="decoration" />\n            </div>\n          </td> '}).join("")+"\n        </tr> "}).join("")+"\n    "),this.$squares=this.$el.find(".square"),this.$squares.click(function(t){return r.presenter.onSquareClick((0,f.default)(t.currentTarget).data("idx"))}),this.resizeGrid()}},{key:"renderSquare",value:function(t){var e=this.$squares.eq(t.idx);e.parent().toggleClass("blacksquare",t.isBlack),e.children(".number").text(t.number||"").show(t.number>0),e.children(".solution").text(t.solution),e.children(".user").text(t.letter),e.toggleClass("correct",t.isCorrect),t.shapebg?e.children(".decoration").addClass("decoration-"+t.shapebg).show():e.children(".decoration").hide()}},{key:"renderRemoteLetter",value:function(t,e){var r=this.$squares.eq(t),n=r.children(".remote");n.length||(n=(0,f.default)('<div class="text remote">').appendTo(r)),n.text(e||"")}},{key:"renderCursor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cursor-highlight";this.$("."+e).removeClass(e),this.$squares.eq(t.idx).parent().addClass(e)}},{key:"renderWordHighlight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"word-highlight";this.$("."+e).removeClass(e);var r=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var u=o.value;this.$squares.eq(u.idx).parent().addClass(e)}}catch(t){n=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}}},{key:"resizeGrid",value:function(){if(this.rows&&this.cols){var t=this.$table,e=this.$el.parent(),r=e.width(),n=e.height(),i=r-1*(this.cols+1),o=n-1*(this.rows+1);if(this._lastWidth!==i||this.lastHeight!==o){i/o>this.aspectRatio?this._scale=o/(t.height()/(this._scale||1)):this._scale=i/(t.width()/(this._scale||1)),this._scale=+this._scale.toFixed(4),(this._scale<0||isNaN(this._scale))&&(this._scale=.1),t.css({fontSize:this._scale+"em"}),t.css({left:Math.max(0,Math.floor((r-t.width())/2)),top:Math.max(0,Math.floor((n-t.height())/2))}),this._lastWidth=i,this._lastHeight=o}}}},{key:"getScale",value:function(){return this._scale||1}}]),e}(),m=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.view,n=void 0===r?new g:r,u=(t.config,i(t,["view","config"]));o(this,e);var l=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s({view:n},u)));return l.puzzle=null,l.bindEvents(),l}return u(e,d.default.Presenter),l(e,[{key:"setPuzzle",value:function(t){var e=this;this.puzzle=t,this.view.createGrid(t.rows,t.cols);var r=!0,n=!1,i=void 0;try{for(var o,a=t.squares[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var u=o.value;this.view.renderSquare(u)}}catch(t){n=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}this.puzzle.on("letter",function(t){return e.view.renderSquare(t)}),this.puzzle.on("cursor",function(t,r){e.view.renderCursor(t);var n=e.puzzle.findSquaresInWord(t,r);e.view.renderWordHighlight(n)})}},{key:"onSquareClick",value:function(t){return this.moveCursor(t),!1}},{key:"bindEvents",value:function(){var t=this;this.$el.contextmenu(function(e){return t.swapOrientation()});var e=new h.default;e.bind("right",function(){return t.moveOne("across","next")}),e.bind("left",function(){return t.moveOne("across","prev")}),e.bind("down",function(){return t.moveOne("down","next")}),e.bind("up",function(){return t.moveOne("down","prev")}),e.bind("shift+right",function(){return t.slideOne("across","next")}),e.bind("shift+left",function(){return t.slideOne("across","prev")}),e.bind("shift+down",function(){return t.slideOne("down","next")}),e.bind("shift+up",function(){return t.slideOne("down","prev")}),e.bind("tab",function(){return t.moveOneClue("next")}),e.bind("shift+tab",function(){return t.moveOneClue("prev")}),e.bind("home",function(){return t.moveCursor(t.puzzle.findWordStart("current"))}),e.bind("end",function(){return t.moveCursor(t.puzzle.findWordEnd("current"))});var r=v.split("").concat(v.toLowerCase().split(""));e.bind(r,function(e,r){return t.enterLetter(r.toUpperCase(),"next")}),e.bind("del",function(){return t.enterLetter("")}),e.bind("backspace",function(){return t.enterLetter("","prev")}),e.bind("space",function(){switch(p.default["grid.keys.space"]){case"orientation":return t.swapOrientation();case"erase":default:return t.enterLetter("","next")}})}},{key:"moveCursor",value:function(t,e){return"number"==typeof t&&(t=this.puzzle.squares[t]),t&&t.isWhite&&this.puzzle.moveCursor(t,e),!1}},{key:"moveClue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.puzzle.currentOrientation,r=void 0;switch(p.default["grid.movement.newClue"]){case"start":r=this.puzzle.findWordStart(t,e);break;case"blank":r=this.findBlank(this.puzzle.findWordStart(t,e),e);break;case null:default:r=t}return this.moveCursor(r||t,e)}},{key:"swapOrientation",value:function(){return this.moveCursor(this.puzzle.currentSquare,this.puzzle.oppositeOrientation),!1}},{key:"enterLetter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.puzzle.currentSquare;return r.letter=t,e&&(r=r[e][this.puzzle.currentOrientation],t&&"blank"===p.default["grid.movement.afterLetter"]&&(r=this.findBlank(r)||r),r&&!r.isBlack&&this.moveCursor(r)),!1}},{key:"moveOne",value:function(t,e){var r=this;if(t!==this.puzzle.currentOrientation&&this.puzzle.currentSquare.isEmpty&&p.default["grid.movement.pauseBeforeSwitch"])return this.moveCursor(this.puzzle.currentSquare,t),!1;var n=this.puzzle.findSquare({from:"current",orientation:t,direction:e,test:function(t){return t!==r.puzzle.currentSquare&&t.isWhite}});return this.moveCursor(n,t),!1}},{key:"slideOne",value:function(t,e){var r=this;if(t===this.puzzle.currentOrientation){var n=this.puzzle.findWordStart("current",t);n=this.puzzle.findSquare({from:n,orientation:t,direction:e+"Wrap",test:function(e){return e!==n&&e.isStart(t)}}),this.moveClue(n)}else{var i=this.puzzle.findSquare({from:"current",orientation:t,direction:e,test:function(t){return t!==r.puzzle.currentSquare&&t.isWhite}});this.moveClue(i)}return!1}},{key:"moveOneClue",value:function(t){var e=this.puzzle.currentOrientation,r=this.puzzle.currentClue.idx,n=void 0;return"next"===t?(n=this.puzzle.clues[e][r+1])||(e="across"===e?"down":"across",n=this.puzzle.clues[e][0]):(n=this.puzzle.clues[e][r-1])||(e="across"===e?"down":"across",n=this.puzzle.clues[e].slice(-1)[0]),this.moveClue(n.square,e),!1}},{key:"findBlank",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.puzzle.currentOrientation;return this.puzzle.findSquare({from:t,orientation:e,inWord:!0,test:function(t){return t.isEmpty}})}},{key:"setRemoteState",value:function(t){var e=this.puzzle.squares[t.cursor],r=t.orientation;this.view.renderCursor(e,"remote-cursor-highlight");var n=this.puzzle.findSquaresInWord(e,r);if(this.view.renderWordHighlight(n,"remote-word-highlight"),p.default["remote.letter.overwrite"])for(var i=0;i<t.grid.length;++i)this.puzzle.state.grid[i]!==t.grid[i]&&(this.puzzle.state.grid[i]=t.grid[i],this.view.renderSquare(this.puzzle.squares[i]));else for(var o=0;o<t.grid.length;++o)this.view.renderRemoteLetter(o,t.grid[o])}}]),e}();e.default=m},function(t,e){t.exports=Mousetrap},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(r(2)),a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"set",value:function(t){var e=[[t,[]]];do{var r=e.pop(),i=n(r,2),a=i[0],u=i[1];for(var s in a){var l=u.concat(s).join("."),c=a[s];o.default.isObject(c)?e.push([c,[l]]):this[l]=c}}while(e.length);return this}},{key:"parse",value:function(t){var e=JSON.parse(t);for(var r in e)this[r]=e[r];return this}},{key:"save",value:function(){return JSON.stringify(this)}}]),t}();e.default=new a},function(t,e){},function(t,e,r){"use strict";function n(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.PromptView=void 0;var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=function(t){return t&&t.__esModule?t:{default:t}}(r(1));r(25);var c='\n  <div class="clue-prompt">\n    <span class="clue-number" />\n    <span class="clue-text" />\n  </div>\n',f=e.PromptView=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.template,a=void 0===r?c:r,s=n(t,["template"]);i(this,e);var l=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,u({template:a},s)));return l.$number=l.$(".clue-number"),l.$text=l.$(".clue-text"),l}return a(e,l.default.View),s(e,[{key:"renderClue",value:function(t){this.$number.html(t.number+t.orientation.slice(0,1).toUpperCase()),this.$text.html(t.text)}}]),e}(),h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.view,a=void 0===r?new f:r,s=n(t,["view"]);i(this,e);var l=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,u({view:a},s)));return l.puzzle=null,l}return a(e,l.default.Presenter),s(e,[{key:"setPuzzle",value:function(t){var e=this;this.puzzle=t,this.puzzle.on("cursor",function(t,r){e.view.renderClue(e.puzzle.currentClue)})}}]),e}();e.default=h},function(t,e){},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ClueListView=void 0;var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},l=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),c=n(r(0)),f=n(r(7)),h=n(r(1));r(27);var p='\n  <div class="clue-list-wrapper">\n    <div class="clue-header" />\n    <ul class="clue-list" />\n  </div>\n',d=e.ClueListView=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.template,n=void 0===r?p:r,u=i(t,["template"]);o(this,e);var l=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s({template:n},u)));return l.$header=l.$(".clue-header"),l.$list=l.$(".clue-list"),l}return u(e,h.default.View),l(e,[{key:"setLayout",value:function(t){this.setExclusiveClass("clues",t)}},{key:"renderClueList",value:function(t,e){var r=this;this.$el.data("orientation",t),this.$header.text(t),this.$list.empty(),this.$list.append(e.map(function(t){return'\n      <li class="clue" data-idx='+t.idx+'>\n        <span class="clue-number">'+t.number+'</span>\n        <span class="clue-text">'+t.text+"</span>\n      </li>\n    "}));var n=e[e.length-1].number;this.$el.toggleClass("clues-3digit",n>=100),this.$("li.clue").click(function(t){return r.presenter.onClueClick((0,c.default)(t.currentTarget).data("idx"))})}},{key:"renderHighlight",value:function(t,e){this.$el.removeClass("highlight-primary highlight-secondary"),this.$el.find(".highlight").removeClass("highlight"),t&&(this.$el.addClass(e?"highlight-primary":"highlight-secondary"),this.highlightClue(t,"highlight"))}},{key:"highlightClue",value:function(t,e){this.$list.children("li").eq(t.idx).addClass(e)}},{key:"onClueClick",value:function(t){}},{key:"scrollTo",value:function(t){if(!this.hasExclusiveClass("clues","tiny")){var e=this.$list;e.stop(),clearTimeout(this._scrollTimeout),this._scrollTimeout=setTimeout(function(){var r=e.find("li").eq(t.idx),n=r.height(),i=r.offset().top,o=i+n,a=e.offset().top,u=a+e.height(),s=n*f.default["cluelist.scroll.buffer"],l=0;switch(f.default["cluelist.scroll.anchor"]){case"middle":(i<a+s||o>u-s)&&(l=(i+o)/2-(a+u)/2);break;case"top":default:(i<a||o>u-2*s)&&(l=i-a)}l&&e.animate({scrollTop:l+e.scrollTop()})},0)}}}]),e}(),v="vertical",y=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.view,n=void 0===r?new d:r,u=(t.config,t.orientation),l=i(t,["view","config","orientation"]);o(this,e);var c=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s({view:n},l)));return c.orientation=u,c.setLayout(v),c.puzzle=null,c}return u(e,h.default.Presenter),l(e,[{key:"setLayout",value:function(t){this.view.setLayout(t)}},{key:"setPuzzle",value:function(t){var e=this;this.puzzle=t,this.view.renderClueList(this.orientation,t.clues[this.orientation]),this.puzzle.on("cursor",function(t){var r=t.clues[e.orientation],n=e.orientation===e.puzzle.currentOrientation;e.view.renderHighlight(r,n),e.view.scrollTo(r)})}},{key:"onClueClick",value:function(t){return this.puzzle.moveCursor(this.puzzle.clues[this.orientation][t].square,this.orientation),!1}}]),e}();e.default=y},function(t,e){},function(t,e,r){"use strict";function n(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.MetadataView=void 0;var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=function(t){return t&&t.__esModule?t:{default:t}}(r(1));r(29);var c='<div class="metadata"></div>',f=e.MetadataView=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.template,a=void 0===r?c:r,s=n(t,["template"]);return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,u({template:a},s)))}return a(e,l.default.View),s(e,[{key:"setHtml",value:function(t){this.$el.html(t),this.$el.show(/\S/.test(this.$el.text()))}}]),e}(),h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.view,a=void 0===r?new f:r,s=t.format,l=n(t,["view","format"]);i(this,e);var c=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,u({view:a},l)));return c.puzzle=null,c.format=s,c}return a(e,l.default.Presenter),s(e,[{key:"setFormat",value:function(t){this.formatter=t,this._updateText()}},{key:"setPuzzle",value:function(t){this.puzzle=t,this._update()}},{key:"_update",value:function(){this.puzzle&&this.format?this.view.setHtml(""+this.format(this.puzzle.meta,this.puzzle)):this.view.setHtml("")}}]),e}();e.default=h},function(t,e){},function(t,e){},function(t,e){}]);